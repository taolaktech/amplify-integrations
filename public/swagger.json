{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":""}},"tags":["App"]}},"/health-check":{"get":{"operationId":"HealthcheckController_index","parameters":[],"responses":{"200":{"description":"The Health Check is successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"ok"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}},"503":{"description":"The Health Check is not successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"error"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"},"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}}},"tags":["Healthcheck"]}},"/api/shopify/auth/callback":{"get":{"operationId":"ShopifyController_shopifyOauthCallback","parameters":[],"responses":{"200":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/auth/url":{"post":{"operationId":"ShopifyController_shopifyOauthUrl","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetShopifyOAuthUrlDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/shop-details":{"post":{"operationId":"ShopifyController_getShopDetails","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetShopDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/shop-branding":{"post":{"operationId":"ShopifyController_getShopBrandingInfo","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetShopBrandingDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/products":{"post":{"operationId":"ShopifyController_getAllProducts","parameters":[{"name":"before","required":false,"in":"query","schema":{"type":"string"}},{"name":"last","required":false,"in":"query","schema":{"type":"number"}},{"name":"after","required":false,"in":"query","schema":{"type":"string"}},{"name":"first","required":false,"in":"query","schema":{"type":"number"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetProductsDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/products/product-by-id":{"post":{"operationId":"ShopifyController_getProductById","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetProductByIdDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/facebook/internal/users/{userId}/primary-ad-account":{"get":{"description":"Used by Lambda functions to get the primary Facebook ad account for campaign creation. Requires API key authentication.","operationId":"InternalFacebookController_getUserPrimaryAdAccountForLambda","parameters":[{"name":"userId","required":true,"in":"path","description":"User ID (MongoDB ObjectId)","schema":{"type":"string"}}],"responses":{"200":{"description":"Primary ad account retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"name":{"type":"string","example":"My Store Ads"},"currency":{"type":"string","example":"USD"},"integrationStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS"}}}}}}}},"404":{"description":"User has no ready ad account for campaigns"}},"summary":"Get user's primary ad account for campaign creation","tags":["Internal Facebook Campaign Controller"]}},"/facebook-campaigns/initialize":{"post":{"description":"Creates the main Facebook campaign structure. This is step 1 of the campaign creation process.","operationId":"FacebookCampaignController_initializeCampaign","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InitializeCampaignDto"}}}},"responses":{"200":{"description":"Campaign initialization started successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CampaignStepResponse"}}}},"400":{"description":"Invalid campaign data or user ad account not ready"}},"summary":"Initialize Facebook campaign creation","tags":["Facebook Campaign Creation"]}},"/facebook-campaigns/{campaignId}/create-adsets":{"post":{"description":"Creates a single Ad Set for the campaign, using the allocated budget and targeting from campaign data. This is step 2.","operationId":"FacebookCampaignController_createAdSets","parameters":[{"name":"campaignId","required":true,"in":"path","description":"Amplify Campaign ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Ad Set created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"currentStep":{"type":"string","example":"ADSETS_CREATED"},"nextStep":{"type":"string","example":"CREATE_CREATIVES"},"message":{"type":"string","example":"Created 1 ad set successfully"},"data":{"type":"object","properties":{"adSetsCreated":{"type":"number","example":1},"adSetIds":{"type":"array","items":{"type":"string"},"example":["fb_adset_123"]},"adSetName":{"type":"string","example":"Amplify AdSet - Product Launch - campaign_id_here"}}}}}}}},"400":{"description":"Bad request (e.g., campaign not initialized, invalid data)"},"404":{"description":"Facebook campaign tracking document not found"}},"summary":"Create Facebook Ad Sets","tags":["Facebook Campaign Creation"]}},"/facebook-campaigns/{campaignId}/create-creatives":{"post":{"description":"Collects all assets (images, text, etc.) from the campaign and creates a single dynamic/flexible creative asset on Facebook. This is step 3.","operationId":"FacebookCampaignController_createCreatives","parameters":[{"name":"campaignId","required":true,"in":"path","description":"Amplify Campaign ID","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"summary":"Create a single Flexible Ad Creative","tags":["Facebook Campaign Creation"]}},"/facebook-campaigns/{campaignId}/create-ads":{"post":{"description":"Creates individual ads linking creatives to ad sets. This is step 4 of the campaign creation process.","operationId":"FacebookCampaignController_createAds","parameters":[{"name":"campaignId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"summary":"Create Facebook Ads","tags":["Facebook Campaign Creation"]}},"/facebook-campaigns/{campaignId}/launch":{"post":{"description":"Submits the campaign for Facebook review and activates it. This is the final step.","operationId":"FacebookCampaignController_launchCampaign","parameters":[{"name":"campaignId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"summary":"Launch Facebook Campaign","tags":["Facebook Campaign Creation"]}},"/facebook-campaigns/{campaignId}/status":{"get":{"description":"Returns the current step and status of the campaign creation process. Useful for polling and orchestration.","operationId":"FacebookCampaignController_getCampaignStatus","parameters":[{"name":"campaignId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Status retrieved successfully."},"404":{"description":"Campaign not found."}},"summary":"Get campaign creation status","tags":["Facebook Campaign Creation"]}},"/facebook-campaigns/{campaignId}/retry-step":{"post":{"description":"If a step in the creation process fails, this endpoint allows the orchestrator (Lambda) to retry it.","operationId":"FacebookCampaignController_retryFailedStep","parameters":[{"name":"campaignId","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RetryStepDto"}}}},"responses":{"200":{"description":"The step was retried successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CampaignStepResponse"}}}},"400":{"description":"The step is not in a retryable state or the retry limit was exceeded."},"404":{"description":"Campaign not found."}},"summary":"Retry a failed campaign creation step","tags":["Facebook Campaign Creation"]}},"/facebook-auth":{"get":{"description":"Redirects user to Facebook OAuth consent page to authorize Amplify access to their ad accounts and pages.","operationId":"FacebookAuthController_redirectToFacebook","parameters":[{"name":"platforms","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"302":{"description":"Redirect to Facebook OAuth consent page"},"500":{"description":"Failed to generate OAuth URL"}},"security":[{"bearer":[]}],"summary":"Initiate Facebook OAuth","tags":["Facebook Authentication"]}},"/facebook-auth/callback":{"get":{"description":"Processes the OAuth callback from Facebook, exchanges code for tokens, and stores user's ad accounts and pages.","operationId":"FacebookAuthController_handleCallback","parameters":[{"name":"state","required":true,"in":"query","description":"State token for security validation","schema":{}},{"name":"code","required":true,"in":"query","description":"Authorization code from Facebook","schema":{}}],"responses":{"200":{"description":"OAuth callback processed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacebookOAuthCallbackResponse"}}}},"400":{"description":"Invalid callback parameters or state token"},"401":{"description":"Invalid or expired state token"},"500":{"description":"Failed to process OAuth callback"}},"security":[{"bearer":[]}],"summary":"Handle Facebook OAuth callback","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts":{"get":{"description":"Retrieves all Facebook ad accounts connected to the user with their integration status, permissions, and capabilities.","operationId":"FacebookAuthController_fetchUserAdAccounts","parameters":[],"responses":{"200":{"description":"Ad accounts retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdAccountsListResponse"}}}},"401":{"description":"User not authenticated"},"500":{"description":"Failed to fetch ad accounts"}},"security":[{"bearer":[]}],"summary":"Get user's Facebook ad accounts","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/{accountId}":{"delete":{"description":"Removes a Facebook ad account from the user's connected accounts. Cannot remove primary account.","operationId":"FacebookAuthController_removeAdAccount","parameters":[{"name":"accountId","required":true,"in":"path","description":"Facebook ad account ID (e.g., act_1234567890)","schema":{"type":"string"}}],"responses":{"200":{"description":"Ad account removed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RemoveAccountResponse"}}}},"400":{"description":"Cannot remove primary ad account"},"401":{"description":"User not authenticated"},"404":{"description":"Ad account not found"}},"security":[{"bearer":[]}],"summary":"Remove Facebook ad account","tags":["Facebook Authentication"]}},"/facebook-auth/instagram-accounts":{"get":{"description":"Retrieves all Instagram business accounts connected to the user Facebook pages.","operationId":"FacebookAuthController_fetchUserInstagramAccounts","parameters":[],"responses":{"200":{"description":"Instagram accounts retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InstagramAccountsListResponse"}}}}},"security":[{"bearer":[]}],"summary":"Get user's Instagram accounts","tags":["Facebook Authentication"]}},"/facebook-auth/instagram-accounts/primary/select":{"post":{"description":"Sets an Instagram account as primary for campaign creation.","operationId":"FacebookAuthController_selectPrimaryInstagramAccount","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SelectPrimaryInstagramAccountDto"}}}},"responses":{"200":{"description":"Primary Instagram account selected successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SelectPrimaryInstagramAccountResponse"}}}}},"security":[{"bearer":[]}],"summary":"Select primary Instagram account","tags":["Facebook Authentication"]}},"/facebook-auth/instagram-accounts/primary":{"get":{"description":"Retrieves the user's primary Instagram account.","operationId":"FacebookAuthController_getPrimaryInstagramAccount","parameters":[],"responses":{"200":{"description":"Primary Instagram account retrieved successfully"}},"security":[{"bearer":[]}],"summary":"Get primary Instagram account","tags":["Facebook Authentication"]}},"/facebook-auth/instagram-setup-status":{"get":{"description":"Checks if user has Instagram Business accounts connected to their Facebook pages.","operationId":"FacebookAuthController_checkInstagramSetupStatus","parameters":[],"responses":{"200":{"description":"Instagram setup status retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InstagramSetupStatusResponse"}}}}},"security":[{"bearer":[]}],"summary":"Check Instagram setup status","tags":["Facebook Authentication"]}},"/facebook-auth/instagram-setup-guide":{"get":{"description":"Provides instructions for connecting Instagram Business accounts to Facebook pages for advertising and integration.","operationId":"FacebookAuthController_getInstagramSetupGuide","parameters":[],"responses":{"200":{"description":""}},"security":[{"bearer":[]}],"summary":"Get Instagram setup guide","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/primary/select":{"post":{"description":"Sets an ad account as primary and requests system user permissions for campaign management. This enables Amplify to create campaigns on the user's behalf.","operationId":"FacebookAuthController_selectPrimaryAdAccount","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SelectPrimaryAdAccountDto"}}}},"responses":{"200":{"description":"Primary ad account selected and system user permissions requested","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SelectPrimaryResponse"}}}},"400":{"description":"Invalid ad account ID or system user assignment failed"},"401":{"description":"User not authenticated or invalid Facebook permissions"},"403":{"description":"Ad account not found or access denied"}},"security":[{"bearer":[]}],"summary":"Select primary ad account","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/primary":{"get":{"description":"Retrieves the user's primary ad account with full integration status, permissions, and campaign readiness information.","operationId":"FacebookAuthController_getPrimaryAdAccount","parameters":[],"responses":{"200":{"description":"Primary ad account retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrimaryAccountResponse"}}}},"401":{"description":"User not authenticated"},"500":{"description":"Failed to get primary ad account"}},"security":[{"bearer":[]}],"summary":"Get primary ad account","tags":["Facebook Authentication"]}},"/facebook-auth/token-status":{"get":{"description":"Checks the health and expiration status of the user's Facebook access token. Provides re-authentication URL if token needs renewal.","operationId":"FacebookAuthController_getTokenStatus","parameters":[],"responses":{"200":{"description":"Token status retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenStatusResponse"}}}},"401":{"description":"User not authenticated"},"500":{"description":"Failed to check token status"}},"security":[{"bearer":[]}],"summary":"Get Facebook token status","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/{accountId}/permission-status":{"get":{"operationId":"FacebookAuthController_getPermissionStatus","parameters":[{"name":"accountId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"security":[{"bearer":[]}],"tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/refresh":{"post":{"description":"Syncs user's ad accounts from Facebook API, detects new accounts, updates existing ones, and checks system user permissions for all accounts.","operationId":"FacebookAuthController_refreshAdAccounts","parameters":[],"responses":{"200":{"description":"Ad accounts refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshAccountsResponse"}}}},"401":{"description":"User not authenticated or Facebook token expired"},"500":{"description":"Failed to refresh ad accounts"}},"security":[{"bearer":[]}],"summary":"Refresh ad accounts from Facebook","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/{accountId}/generate-meta-pixel-id":{"post":{"operationId":"FacebookAuthController_generateMetaPixelId","parameters":[{"name":"accountId","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMetaPixelDto"}}}},"responses":{"201":{"description":""}},"security":[{"bearer":[]}],"tags":["Facebook Authentication"]}}},"info":{"title":"Amplify-Integrations Api","description":"Amplify Integrations Api","version":"1.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"x-api-key":{"type":"apiKey","in":"header","name":"x-api-key"}},"schemas":{"GetShopifyOAuthUrlDto":{"type":"object","properties":{"shop":{"type":"string"},"userId":{"type":"string"}},"required":["shop","userId"]},"GetShopDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"}},"required":["shop","accessToken","scope"]},"GetShopBrandingDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"}},"required":["shop","accessToken","scope"]},"GetProductsDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"}},"required":["shop","accessToken","scope"]},"GetProductByIdDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"},"productId":{"type":"string"},"handle":{"type":"string"}},"required":["shop","accessToken","scope","productId","handle"]},"CampaignLocationDto":{"type":"object","properties":{"country":{"type":"string","description":"Country code","example":"US"},"city":{"type":"string","description":"City name","example":"New York"},"state":{"type":"string","description":"State/Province code","example":"NY"}},"required":["country","city","state"]},"CreativeDto":{"type":"object","properties":{"id":{"type":"string","description":"Creative ID","example":"creative_123"},"channel":{"type":"string","description":"Advertising channel","example":"facebook","enum":["facebook","instagram","google"]},"budget":{"type":"number","description":"Budget allocated for this creative","example":100.5},"data":{"description":"Creative data URLs","example":["{\"url\":\"http://s3.image.com/fb-ad-1\"}"],"type":"array","items":{"type":"string"}}},"required":["id","channel","budget","data"]},"ProductDto":{"type":"object","properties":{"shopifyId":{"type":"string","description":"Shopify product ID","example":"gid://shopify/Product/123456789"},"title":{"type":"string","description":"Product title","example":"Premium Wireless Headphones"},"price":{"type":"number","description":"Product price","example":199.99},"description":{"type":"string","description":"Product description","example":"High-quality wireless headphones with noise cancellation"},"audience":{"type":"string","description":"Target audience for this product","example":"Young professionals"},"occasion":{"type":"string","description":"Occasion for this product","example":"Birthday gift"},"features":{"description":"Product features","example":["Noise cancellation","30-hour battery","Bluetooth 5.0"],"type":"array","items":{"type":"string"}},"category":{"type":"string","description":"Product category","example":"Electronics"},"imageLink":{"type":"string","description":"Product image URL","example":"https://example.com/images/product-123.jpg"},"productLink":{"type":"string","description":"Product page URL","example":"https://shop.com/products/premium-headphones"},"creatives":{"description":"Creatives for this product","type":"array","items":{"$ref":"#/components/schemas/CreativeDto"}}},"required":["shopifyId","title","price","description","features","category","imageLink","productLink","creatives"]},"CampaignDataFromLambdaClass":{"type":"object","properties":{"campaignId":{"type":"string","description":"MongoDB ObjectId as string","example":"507f1f77bcf86cd799439011"},"pageId":{"type":"string","description":"Facebook Page ID","example":"86210912001"},"metaPixelId":{"type":"string","description":"Meta Pixel ID for tracking","example":"1234567890"},"userId":{"type":"string","description":"User ID who created the campaign","example":"user_123456789"},"businessId":{"type":"string","description":"Business ID this campaign belongs to","example":"business_987654321"},"type":{"type":"string","description":"Campaign type","example":"PRODUCT_LAUNCH"},"brandColor":{"type":"string","description":"Brand primary color","example":"#FF5733"},"accentColor":{"type":"string","description":"Brand accent color","example":"#33FF57"},"tone":{"type":"string","description":"Tone for ad copy","example":"Professional"},"startDate":{"type":"string","description":"Campaign start date (ISO string)","example":"2024-01-01T00:00:00.000Z"},"endDate":{"type":"string","description":"Campaign end date (ISO string)","example":"2024-12-31T23:59:59.999Z"},"totalBudget":{"type":"number","description":"Total budget across all platforms","example":5000},"platforms":{"type":"array","description":"Advertising platforms","example":["FACEBOOK","INSTAGRAM","GOOGLE"],"items":{"type":"string","enum":["FACEBOOK","INSTAGRAM","GOOGLE"]}},"location":{"description":"Targeting locations","type":"array","items":{"$ref":"#/components/schemas/CampaignLocationDto"}},"products":{"description":"Products to advertise","type":"array","items":{"$ref":"#/components/schemas/ProductDto"}}},"required":["campaignId","pageId","metaPixelId","userId","businessId","type","brandColor","accentColor","tone","startDate","endDate","totalBudget","platforms","location","products"]},"InitializeCampaignDto":{"type":"object","properties":{"campaignData":{"description":"Campaign data from Amplify-Manager via Lambda","allOf":[{"$ref":"#/components/schemas/CampaignDataFromLambdaClass"}]},"userAdAccountId":{"type":"string","description":"User Ad Account ID","example":"act_123456789012345"}},"required":["campaignData","userAdAccountId"]},"CampaignStepResponse":{"type":"object","properties":{}},"RetryStepDto":{"type":"object","properties":{"step":{"type":"string","example":"CREATING_ADSETS","description":"The step that failed and needs to be retried.","enum":["INITIALIZING","CREATING_ADSETS","CREATING_CREATIVES","CREATING_ADS","LAUNCHING"]}},"required":["step"]},"SystemUserPermissionDto":{"type":"object","properties":{"assignmentStatus":{"type":"string","example":"ASSIGNED","enum":["NOT_REQUESTED","ASSIGNMENT_PENDING","ASSIGNED","ASSIGNMENT_FAILED"]},"grantedTasks":{"example":["MANAGE","ADVERTISE","ANALYZE"],"type":"array","items":{"type":"string"}},"lastStatusCheck":{"format":"date-time","type":"string","example":"2024-01-01T10:00:00Z"},"assignmentError":{"type":"string","example":"Permission check failed"}},"required":["assignmentStatus","grantedTasks","lastStatusCheck"]},"CapabilitiesDto":{"type":"object","properties":{"canCreateCampaigns":{"type":"boolean","example":true},"canManageAds":{"type":"boolean","example":true},"canViewInsights":{"type":"boolean","example":true},"grantedTasks":{"example":["MANAGE","ADVERTISE","ANALYZE"],"type":"array","items":{"type":"string"}},"missingTasks":{"example":[],"type":"array","items":{"type":"string"}}},"required":["canCreateCampaigns","canManageAds","canViewInsights","grantedTasks","missingTasks"]},"FacebookAdAccountDto":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"name":{"type":"string","example":"My Store Ads"},"currency":{"type":"string","example":"USD"},"businessName":{"type":"string","example":"My Business"},"isPrimary":{"type":"boolean","example":true},"integrationStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS","enum":["SETUP_INCOMPLETE","SYSTEM_USER_ASSIGNED","ASSIGNMENT_FAILED","READY_FOR_CAMPAIGNS"]},"systemUserPermission":{"$ref":"#/components/schemas/SystemUserPermissionDto"},"capabilities":{"$ref":"#/components/schemas/CapabilitiesDto"}},"required":["accountId","isPrimary","integrationStatus"]},"InstagramAccountDto":{"type":"object","properties":{"instagramAccountId":{"type":"string","example":"17841400000000000"},"username":{"type":"string","example":"mybusiness"},"accountType":{"type":"string","example":"BUSINESS","enum":["BUSINESS","CREATOR"]},"followersCount":{"type":"number","example":1500},"mediaCount":{"type":"number","example":42},"pageId":{"type":"string","example":"123456789012345"},"pageName":{"type":"string","example":"My Business Page"},"isPrimary":{"type":"boolean","example":false}},"required":["instagramAccountId","username","accountType","followersCount","mediaCount","pageId","pageName","isPrimary"]},"OAuthCallbackDataDto":{"type":"object","properties":{"adAccounts":{"type":"array","items":{"$ref":"#/components/schemas/FacebookAdAccountDto"}},"pages":{"description":"Facebook pages data","type":"array","items":{"type":"object"}},"instagramAccounts":{"type":"array","items":{"$ref":"#/components/schemas/InstagramAccountDto"}},"tokenStored":{"type":"boolean","example":true},"needsAdAccountSelection":{"type":"boolean","example":true},"needsInstagramAccountSelection":{"type":"boolean","example":false},"hasInstagramAccounts":{"type":"boolean","example":false},"pagesWithoutInstagram":{"type":"number","example":2}},"required":["adAccounts","pages","tokenStored","needsAdAccountSelection","needsInstagramAccountSelection"]},"FacebookOAuthCallbackResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Facebook OAuth callback handled successfully"},"data":{"$ref":"#/components/schemas/OAuthCallbackDataDto"}},"required":["success","message","data"]},"AdAccountsListDataDto":{"type":"object","properties":{"adAccounts":{"type":"array","items":{"$ref":"#/components/schemas/FacebookAdAccountDto"}},"hasPrimary":{"type":"boolean","example":true},"total":{"type":"number","example":3},"readyForCampaigns":{"type":"number","example":1},"needsSetup":{"type":"number","example":2},"assignmentFailed":{"type":"number","example":0}},"required":["adAccounts","hasPrimary","total","readyForCampaigns","needsSetup","assignmentFailed"]},"AdAccountsListResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Ad accounts retrieved successfully"},"data":{"$ref":"#/components/schemas/AdAccountsListDataDto"}},"required":["success","message","data"]},"RemoveAccountResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Ad account removed successfully"}},"required":["success","message"]},"InstagramAccountsListDataDto":{"type":"object","properties":{"instagramAccounts":{"type":"array","items":{"$ref":"#/components/schemas/InstagramAccountDto"}},"hasPrimary":{"type":"boolean","example":true},"total":{"type":"number","example":2}},"required":["instagramAccounts","hasPrimary","total"]},"InstagramAccountsListResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Instagram accounts retrieved successfully"},"data":{"$ref":"#/components/schemas/InstagramAccountsListDataDto"}},"required":["success","message","data"]},"SelectPrimaryInstagramAccountDto":{"type":"object","properties":{}},"SelectPrimaryInstagramAccountDataDto":{"type":"object","properties":{"instagramAccountId":{"type":"string","example":"17841400000000000"},"username":{"type":"string","example":"mybusiness"},"pageId":{"type":"string","example":"123456789012345"},"pageName":{"type":"string","example":"My Business Page"}},"required":["instagramAccountId","username","pageId","pageName"]},"SelectPrimaryInstagramAccountResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Primary Instagram account selected successfully"},"data":{"$ref":"#/components/schemas/SelectPrimaryInstagramAccountDataDto"}},"required":["success","message","data"]},"InstagramSetupStatusDataDto":{"type":"object","properties":{"hasInstagramAccounts":{"type":"boolean","example":true},"instagramAccountCount":{"type":"number","example":2},"pagesWithInstagramCount":{"type":"number","example":2},"pagesWithoutInstagramCount":{"type":"number","example":1},"pagesWithoutInstagram":{"example":[{"pageId":"123456789012345","pageName":"My Business Page"}],"type":"array","items":{"type":"object"}},"instagramAccounts":{"example":[{"instagramAccountId":"17841400000000000","username":"mybusiness","pageId":"123456789012345","pageName":"My Business Page","isPrimary":true}],"type":"array","items":{"type":"object"}}},"required":["hasInstagramAccounts","instagramAccountCount","pagesWithInstagramCount","pagesWithoutInstagramCount","pagesWithoutInstagram","instagramAccounts"]},"InstagramSetupStatusResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Found 2 Instagram account(s)"},"data":{"$ref":"#/components/schemas/InstagramSetupStatusDataDto"}},"required":["success","message","data"]},"SelectPrimaryAdAccountDto":{"type":"object","properties":{"adAccountId":{"type":"string","example":"act_123456789","description":"Facebook Ad Account ID to set as primary"}},"required":["adAccountId"]},"SelectPrimaryDataDto":{"type":"object","properties":{"adAccountId":{"type":"string","example":"act_1087932189349950"},"assignmentStatus":{"type":"string","example":"ASSIGNED","enum":["ASSIGNED","ASSIGNMENT_FAILED"]},"canCreateCampaigns":{"type":"boolean","example":true},"grantedTasks":{"example":["MANAGE","ADVERTISE","ANALYZE"],"type":"array","items":{"type":"string"}},"message":{"type":"string","example":"Account selected successfully"}},"required":["adAccountId","assignmentStatus","canCreateCampaigns","grantedTasks","message"]},"SelectPrimaryResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Primary ad account set and ready for campaigns"},"data":{"$ref":"#/components/schemas/SelectPrimaryDataDto"}},"required":["success","message","data"]},"PrimaryAccountDataDto":{"type":"object","properties":{"account":{"$ref":"#/components/schemas/FacebookAdAccountDto"},"integrationStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS","enum":["SETUP_INCOMPLETE","SYSTEM_USER_ASSIGNED","ASSIGNMENT_FAILED","READY_FOR_CAMPAIGNS"]},"systemUserPermission":{"$ref":"#/components/schemas/SystemUserPermissionDto"},"capabilities":{"$ref":"#/components/schemas/CapabilitiesDto"},"readyForCampaigns":{"type":"boolean","example":true}},"required":["account","integrationStatus","systemUserPermission","capabilities","readyForCampaigns"]},"PrimaryAccountResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Primary ad account retrieved successfully"},"data":{"$ref":"#/components/schemas/PrimaryAccountDataDto"},"hasPrimary":{"type":"boolean","example":true}},"required":["success","message","hasPrimary"]},"TokenStatusDataDto":{"type":"object","properties":{"hasValidToken":{"type":"boolean","example":true},"expiresAt":{"format":"date-time","type":"string","example":"2024-02-15T10:00:00Z"},"daysUntilExpiry":{"type":"number","example":45},"needsReauth":{"type":"boolean","example":false},"reAuthUrl":{"type":"string","example":null}},"required":["hasValidToken","needsReauth"]},"TokenStatusResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Token is healthy and valid for 45 more days"},"data":{"$ref":"#/components/schemas/TokenStatusDataDto"}},"required":["success","message","data"]},"NewAccountDto":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"name":{"type":"string","example":"My New Store Ads"},"currency":{"type":"string","example":"USD"},"businessName":{"type":"string","example":"My Business"}},"required":["accountId","name","currency","businessName"]},"PermissionUpdateDto":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"oldStatus":{"type":"string","example":"SETUP_INCOMPLETE"},"newStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS"},"capabilities":{"$ref":"#/components/schemas/CapabilitiesDto"}},"required":["accountId","oldStatus","newStatus","capabilities"]},"TokenStatusDto":{"type":"object","properties":{"isValid":{"type":"boolean","example":true},"expiresAt":{"format":"date-time","type":"string","example":"2024-02-15T10:00:00Z"},"daysUntilExpiry":{"type":"number","example":45}},"required":["isValid"]},"RefreshAccountsDataDto":{"type":"object","properties":{"newAccountsFound":{"type":"number","example":1},"accountsUpdated":{"type":"number","example":2},"permissionsUpdated":{"type":"number","example":1},"accountsRemoved":{"type":"number","example":0},"totalAccounts":{"type":"number","example":4},"newAccounts":{"type":"array","items":{"$ref":"#/components/schemas/NewAccountDto"}},"permissionUpdates":{"type":"array","items":{"$ref":"#/components/schemas/PermissionUpdateDto"}},"tokenStatus":{"$ref":"#/components/schemas/TokenStatusDto"}},"required":["newAccountsFound","accountsUpdated","permissionsUpdated","accountsRemoved","totalAccounts","newAccounts","permissionUpdates","tokenStatus"]},"RefreshAccountsResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Found 1 new ad account and updated 2 existing accounts"},"data":{"$ref":"#/components/schemas/RefreshAccountsDataDto"}},"required":["success","message","data"]},"CreateMetaPixelDto":{"type":"object","properties":{}}}}}
