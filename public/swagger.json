{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":""}},"tags":["App"]}},"/health-check":{"get":{"operationId":"HealthcheckController_index","parameters":[],"responses":{"200":{"description":"The Health Check is successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"ok"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}},"503":{"description":"The Health Check is not successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"error"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"},"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}}},"tags":["Healthcheck"]}},"/api/shopify/auth/callback":{"get":{"operationId":"ShopifyController_shopifyOauthCallback","parameters":[],"responses":{"200":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/auth/url":{"post":{"operationId":"ShopifyController_shopifyOauthUrl","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetShopifyOAuthUrlDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/shop-details":{"post":{"operationId":"ShopifyController_getShopDetails","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetShopDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/shop-branding":{"post":{"operationId":"ShopifyController_getShopBrandingInfo","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetShopBrandingDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/products":{"post":{"operationId":"ShopifyController_getAllProducts","parameters":[{"name":"before","required":false,"in":"query","schema":{"type":"string"}},{"name":"last","required":false,"in":"query","schema":{"type":"number"}},{"name":"after","required":false,"in":"query","schema":{"type":"string"}},{"name":"first","required":false,"in":"query","schema":{"type":"number"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetProductsDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/api/shopify/products/product-by-id":{"post":{"operationId":"ShopifyController_getProductById","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetProductByIdDto"}}}},"responses":{"201":{"description":""}},"security":[{"x-api-key":[]}],"tags":["Shopify"]}},"/campaign":{"post":{"description":"This endpoint validates and creates a new marketing campaign, persisting it to the database and preparing it for processing.","operationId":"CampaignController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCampaignDto"}}}},"responses":{"201":{"description":"The campaign has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CampaignResponse"}}}},"400":{"description":"Bad Request. The request body is invalid or missing required fields."},"500":{"description":"Internal Server Error. An unexpected error occurred on the server."}},"summary":"Create a new campaign","tags":["Campaigns"]},"get":{"operationId":"CampaignController_findAll","parameters":[{"name":"page","required":false,"in":"query","description":"The page number to retrieve.","schema":{"default":1,"type":"number"}},{"name":"perPage","required":false,"in":"query","description":"The number of items to return per page.","schema":{"default":10,"type":"number"}},{"name":"status","required":false,"in":"query","description":"Filter campaigns by status.","schema":{"type":"string","enum":["DRAFT","ACTIVE","PAUSED","COMPLETED","ARCHIVED"]}},{"name":"type","required":false,"in":"query","description":"Filter campaigns by type.","schema":{"type":"string","enum":["Product Launch","Flash Sale / Limited Time","Abandoned Cart Recovery","Upsell / Cross-sell","Seasonal Campaigns","Free Shipping Promo","Customer Reactivation","Bestseller Boost","High ROAS Booster","Slow-Mover Inventory Push"]}},{"name":"platforms","required":false,"in":"query","description":"Filter campaigns by one or more platforms.","schema":{"type":"array","items":{"type":"string","enum":["FACEBOOK","INSTAGRAM","GOOGLE"]}}},{"name":"sortBy","required":false,"in":"query","description":"Sort results by a field and direction (e.g., \"createdAt:desc\").","schema":{"default":"createdAt:desc","type":"string"}}],"responses":{"200":{"description":"A paginated list of campaigns.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedCampaignResponse"}}}}},"summary":"List campaigns for the authenticated user","tags":["Campaigns"]}},"/campaign/{id}":{"patch":{"operationId":"CampaignController_update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateCampaignDto"}}}},"responses":{"200":{"description":"Campaign updated successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CampaignResponse"}}}},"400":{"description":"Bad Request. The request body is empty or invalid."},"404":{"description":"Not Found. Campaign with the specified ID not found."}},"summary":"Update an existing campaign","tags":["Campaigns"]},"get":{"description":"Retrieves the full details of a specific campaign using its unique MongoDB ObjectId.","operationId":"CampaignController_findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"The campaign was found and returned successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CampaignResponse"}}}},"404":{"description":"Not Found. No campaign with the specified ID exists."},"500":{"description":"Internal Server Error. An unexpected error occurred on the server."}},"summary":"Get a single campaign by ID","tags":["Campaigns"]}},"/facebook-auth":{"get":{"description":"Redirects user to Facebook OAuth consent page to authorize Amplify access to their ad accounts and pages.","operationId":"FacebookAuthController_redirectToFacebook","parameters":[],"responses":{"302":{"description":"Redirect to Facebook OAuth consent page"},"500":{"description":"Failed to generate OAuth URL"}},"security":[{"bearer":[]}],"summary":"Initiate Facebook OAuth","tags":["Facebook Authentication"]}},"/facebook-auth/callback":{"get":{"description":"Processes the OAuth callback from Facebook, exchanges code for tokens, and stores user's ad accounts and pages.","operationId":"FacebookAuthController_handleCallback","parameters":[{"name":"state","required":true,"in":"query","description":"State token for security validation","schema":{}},{"name":"code","required":true,"in":"query","description":"Authorization code from Facebook","schema":{}}],"responses":{"200":{"description":"OAuth callback processed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FacebookOAuthCallbackResponse"}}}},"400":{"description":"Invalid callback parameters or state token"},"401":{"description":"Invalid or expired state token"},"500":{"description":"Failed to process OAuth callback"}},"security":[{"bearer":[]}],"summary":"Handle Facebook OAuth callback","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts":{"get":{"description":"Retrieves all Facebook ad accounts connected to the user with their integration status, permissions, and capabilities.","operationId":"FacebookAuthController_fetchUserAdAccounts","parameters":[],"responses":{"200":{"description":"Ad accounts retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdAccountsListResponse"}}}},"401":{"description":"User not authenticated"},"500":{"description":"Failed to fetch ad accounts"}},"security":[{"bearer":[]}],"summary":"Get user's Facebook ad accounts","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/{accountId}":{"delete":{"description":"Removes a Facebook ad account from the user's connected accounts. Cannot remove primary account.","operationId":"FacebookAuthController_removeAdAccount","parameters":[{"name":"accountId","required":true,"in":"path","description":"Facebook ad account ID (e.g., act_1234567890)","schema":{"type":"string"}}],"responses":{"200":{"description":"Ad account removed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RemoveAccountResponse"}}}},"400":{"description":"Cannot remove primary ad account"},"401":{"description":"User not authenticated"},"404":{"description":"Ad account not found"}},"security":[{"bearer":[]}],"summary":"Remove Facebook ad account","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/select-primary":{"post":{"description":"Sets an ad account as primary and requests system user permissions for campaign management. This enables Amplify to create campaigns on the user's behalf.","operationId":"FacebookAuthController_selectPrimaryAdAccount","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SelectPrimaryAdAccountDto"}}}},"responses":{"200":{"description":"Primary ad account selected and system user permissions requested","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SelectPrimaryResponse"}}}},"400":{"description":"Invalid ad account ID or system user assignment failed"},"401":{"description":"User not authenticated or invalid Facebook permissions"},"403":{"description":"Ad account not found or access denied"}},"security":[{"bearer":[]}],"summary":"Select primary ad account","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/primary":{"get":{"description":"Retrieves the user's primary ad account with full integration status, permissions, and campaign readiness information.","operationId":"FacebookAuthController_getPrimaryAdAccount","parameters":[],"responses":{"200":{"description":"Primary ad account retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrimaryAccountResponse"}}}},"401":{"description":"User not authenticated"},"500":{"description":"Failed to get primary ad account"}},"security":[{"bearer":[]}],"summary":"Get primary ad account","tags":["Facebook Authentication"]}},"/facebook-auth/token-status":{"get":{"description":"Checks the health and expiration status of the user's Facebook access token. Provides re-authentication URL if token needs renewal.","operationId":"FacebookAuthController_getTokenStatus","parameters":[],"responses":{"200":{"description":"Token status retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenStatusResponse"}}}},"401":{"description":"User not authenticated"},"500":{"description":"Failed to check token status"}},"security":[{"bearer":[]}],"summary":"Get Facebook token status","tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/{accountId}/permission-status":{"get":{"operationId":"FacebookAuthController_getPermissionStatus","parameters":[{"name":"accountId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"security":[{"bearer":[]}],"tags":["Facebook Authentication"]}},"/facebook-auth/ad-accounts/refresh":{"post":{"description":"Syncs user's ad accounts from Facebook API, detects new accounts, updates existing ones, and checks system user permissions for all accounts.","operationId":"FacebookAuthController_refreshAdAccounts","parameters":[],"responses":{"200":{"description":"Ad accounts refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshAccountsResponse"}}}},"401":{"description":"User not authenticated or Facebook token expired"},"500":{"description":"Failed to refresh ad accounts"}},"security":[{"bearer":[]}],"summary":"Refresh ad accounts from Facebook","tags":["Facebook Authentication"]}}},"info":{"title":"Amplify-Integrations Api","description":"Amplify Integrations Api","version":"1.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"x-api-key":{"type":"apiKey","in":"header","name":"x-api-key"}},"schemas":{"GetShopifyOAuthUrlDto":{"type":"object","properties":{"shop":{"type":"string"},"userId":{"type":"string"},"redirect":{"type":"string"}},"required":["shop","userId","redirect"]},"GetShopDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"}},"required":["shop","accessToken","scope"]},"GetShopBrandingDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"}},"required":["shop","accessToken","scope"]},"GetProductsDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"}},"required":["shop","accessToken","scope"]},"GetProductByIdDto":{"type":"object","properties":{"shop":{"type":"string"},"accessToken":{"type":"string"},"scope":{"type":"string"},"productId":{"type":"string"},"handle":{"type":"string"}},"required":["shop","accessToken","scope","productId","handle"]},"CreativeDto":{"type":"object","properties":{"channel":{"type":"string","description":"The advertising channel for this creative (e.g., \"facebook\", \"google\").","example":"facebook"},"budget":{"type":"number","description":"The budget allocated specifically to this creative.","example":500,"minimum":0},"data":{"description":"An array of data for the creative, such as image URLs or ad copy text.","example":["https://example.com/image1.jpg","Summer Sale!"],"type":"array","items":{"type":"string"}}},"required":["channel","budget","data"]},"ProductDto":{"type":"object","properties":{"title":{"type":"string","description":"The title of the product."},"price":{"type":"number","description":"The price of the product.","minimum":0},"description":{"type":"string","description":"A detailed description of the product."},"audience":{"type":"string","description":"The target audience for the product."},"occasion":{"type":"string","description":"The occasion this product is suitable for."},"features":{"description":"Key features of the product.","type":"array","items":{"type":"string"}},"category":{"type":"string","description":"The product category."},"imageLink":{"type":"string","description":"A URL to the main product image."},"productLink":{"type":"string","description":"A URL to the product page."},"creatives":{"description":"A list of creatives for this product.","type":"array","items":{"$ref":"#/components/schemas/CreativeDto"}}},"required":["title","price","description","audience","occasion","features","category","imageLink","productLink","creatives"]},"LocationDto":{"type":"object","properties":{"city":{"type":"string","description":"The city of the target location.","example":"Manhattan"},"state":{"type":"string","description":"The name of the target location.","example":"New York"},"country":{"type":"string","description":"The country of the target location.","example":"USA"}},"required":["city","state","country"]},"CreateCampaignDto":{"type":"object","properties":{"businessId":{"type":"string","description":"The ID of the business this campaign belongs to.","example":"64f5f1e1e6b3c6a7e8e1b3c6"},"type":{"type":"string","enum":["Product Launch","Flash Sale / Limited Time","Abandoned Cart Recovery","Upsell / Cross-sell","Seasonal Campaigns","Free Shipping Promo","Customer Reactivation","Bestseller Boost","High ROAS Booster","Slow-Mover Inventory Push"],"description":"The type of the campaign.","example":"Product Launch"},"platforms":{"type":"array","description":"A list of platforms to target for the campaign.","example":["FACEBOOK","GOOGLE"],"items":{"type":"string","enum":["FACEBOOK","INSTAGRAM","GOOGLE"]}},"brandColor":{"type":"string","description":"The primary color theme for the campaign creative.","example":"#3b5998"},"accentColor":{"type":"string","description":"The accent color theme for the campaign creative.","example":"#3b5998"},"tone":{"type":"string","description":"The desired tone of voice for the campaign ad copy.","example":"Playful and energetic"},"startDate":{"type":"string","description":"The start date and time for the campaign in ISO 8601 format.","example":"2024-10-01T09:00:00Z"},"endDate":{"type":"string","description":"The end date and time for the campaign in ISO 8601 format.","example":"2024-10-31T23:59:59Z"},"totalBudget":{"type":"number","description":"The total budget for the entire campaign.","example":10000,"minimum":1},"products":{"description":"The list of products included in this campaign.","type":"array","items":{"$ref":"#/components/schemas/ProductDto"}},"location":{"description":"A list of geographical locations to target.","type":"array","items":{"$ref":"#/components/schemas/LocationDto"}}},"required":["businessId","type","platforms","brandColor","accentColor","tone","startDate","endDate","totalBudget","products","location"]},"ObjectId":{"type":"object","properties":{}},"Creative":{"type":"object","properties":{"id":{"type":"string","example":"1234567890","description":"Unique identifier for the creative."},"channel":{"type":"string","example":"facebook","description":"The advertising channel."},"budget":{"type":"number","example":100,"description":"The budget for the creative."},"data":{"example":["https://example.com/image.jpg"],"description":"Array of creative assets (URLs, text).","type":"array","items":{"type":"string"}}},"required":["id","channel","budget","data"]},"Product":{"type":"object","properties":{"title":{"type":"string","example":"AeroStride Pro Shoes","description":"Product title."},"price":{"type":"number","example":159.99,"description":"Product price."},"description":{"type":"string","example":"Next-gen running shoes.","description":"Product description."},"audience":{"type":"string","example":"Serious runners","description":"Target audience for the product."},"occasion":{"type":"string","example":"Race day","description":"Suitable occasion."},"features":{"example":["Carbon fiber plate"],"description":"List of product features.","type":"array","items":{"type":"string"}},"category":{"type":"string","example":"Footwear","description":"Product category."},"imageLink":{"type":"string","example":"https://example.com/image.png","description":"URL to product image."},"productLink":{"type":"string","example":"https://example.com/product/123","description":"URL to product page."},"creatives":{"description":"List of creatives for this product.","type":"array","items":{"$ref":"#/components/schemas/Creative"}}},"required":["title","price","description","audience","occasion","features","category","imageLink","productLink","creatives"]},"Location":{"type":"object","properties":{"country":{"type":"string","example":"United States","description":"The country."},"city":{"type":"string","example":"Manhattan","description":"Target city."},"state":{"type":"string","example":"New York","description":"Target state."}},"required":["country","city","state"]},"Campaign":{"type":"object","properties":{"status":{"type":"string","enum":["DRAFT","ACTIVE","PAUSED","COMPLETED","ARCHIVED"],"example":"DRAFT","description":"The current status of the campaign."},"businessId":{"example":"65e5d6a8c4b1a8d4b3c9d7b2","description":"The ID of the associated business.","allOf":[{"$ref":"#/components/schemas/ObjectId"}]},"type":{"type":"string","enum":["Product Launch","Flash Sale / Limited Time","Abandoned Cart Recovery","Upsell / Cross-sell","Seasonal Campaigns","Free Shipping Promo","Customer Reactivation","Bestseller Boost","High ROAS Booster","Slow-Mover Inventory Push"],"example":"Product Launch","description":"The type of campaign."},"brandColor":{"type":"string","example":"#3b5998","description":"Primary campaign color."},"accentColor":{"type":"string","example":"#3b5998","description":"Primary campaign color."},"tone":{"type":"string","example":"Playful and energetic","description":"Tone of voice for ad copy."},"startDate":{"format":"date-time","type":"string","example":"2024-08-01T00:00:00Z","description":"Campaign start date."},"endDate":{"format":"date-time","type":"string","example":"2024-08-31T23:59:59Z","description":"Campaign end date."},"totalBudget":{"type":"number","example":15000,"description":"Total campaign budget."},"products":{"description":"List of products in the campaign.","type":"array","items":{"$ref":"#/components/schemas/Product"}},"location":{"description":"List of targeted locations.","type":"array","items":{"$ref":"#/components/schemas/Location"}},"platforms":{"type":"array","example":["FACEBOOK","GOOGLE"],"description":"List of targeted platforms.","items":{"type":"string","enum":["FACEBOOK","INSTAGRAM","GOOGLE"]}}},"required":["status","businessId","type","brandColor","accentColor","tone","startDate","endDate","totalBudget","products","location","platforms"]},"CampaignResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Campaign created successfully"},"data":{"$ref":"#/components/schemas/Campaign"}},"required":["success","message","data"]},"UpdateCampaignDto":{"type":"object","properties":{"type":{"type":"string","enum":["Product Launch","Flash Sale / Limited Time","Abandoned Cart Recovery","Upsell / Cross-sell","Seasonal Campaigns","Free Shipping Promo","Customer Reactivation","Bestseller Boost","High ROAS Booster","Slow-Mover Inventory Push"],"description":"The type of the campaign.","example":"Product Launch"},"startDate":{"type":"string","description":"The start date and time for the campaign in ISO 8601 format.","example":"2024-10-01T09:00:00Z"},"endDate":{"type":"string","description":"The end date and time for the campaign in ISO 8601 format.","example":"2024-10-31T23:59:59Z"},"brandColor":{"type":"string","description":"The primary color theme for the campaign creative.","example":"#3b5998"},"accentColor":{"type":"string","description":"The accent color theme for the campaign creative.","example":"#3b5998"}},"required":["type","startDate","endDate","brandColor","accentColor"]},"PaginationMeta":{"type":"object","properties":{"total":{"type":"number"},"page":{"type":"number"},"perPage":{"type":"number"},"totalPages":{"type":"number"},"hasNextPage":{"type":"boolean"},"hasPrevPage":{"type":"boolean"}},"required":["total","page","perPage","totalPages","hasNextPage","hasPrevPage"]},"PaginatedCampaignResponse":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/Campaign"}},"pagination":{"$ref":"#/components/schemas/PaginationMeta"}},"required":["data","pagination"]},"SystemUserPermissionDto":{"type":"object","properties":{"assignmentStatus":{"type":"string","example":"ASSIGNED","enum":["NOT_REQUESTED","ASSIGNMENT_PENDING","ASSIGNED","ASSIGNMENT_FAILED"]},"grantedTasks":{"example":["MANAGE","ADVERTISE","ANALYZE"],"type":"array","items":{"type":"string"}},"lastStatusCheck":{"format":"date-time","type":"string","example":"2024-01-01T10:00:00Z"},"assignmentError":{"type":"string","example":"Permission check failed"}},"required":["assignmentStatus","grantedTasks","lastStatusCheck"]},"CapabilitiesDto":{"type":"object","properties":{"canCreateCampaigns":{"type":"boolean","example":true},"canManageAds":{"type":"boolean","example":true},"canViewInsights":{"type":"boolean","example":true},"grantedTasks":{"example":["MANAGE","ADVERTISE","ANALYZE"],"type":"array","items":{"type":"string"}},"missingTasks":{"example":[],"type":"array","items":{"type":"string"}}},"required":["canCreateCampaigns","canManageAds","canViewInsights","grantedTasks","missingTasks"]},"FacebookAdAccountDto":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"name":{"type":"string","example":"My Store Ads"},"currency":{"type":"string","example":"USD"},"businessName":{"type":"string","example":"My Business"},"isPrimary":{"type":"boolean","example":true},"integrationStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS","enum":["SETUP_INCOMPLETE","SYSTEM_USER_ASSIGNED","ASSIGNMENT_FAILED","READY_FOR_CAMPAIGNS"]},"systemUserPermission":{"$ref":"#/components/schemas/SystemUserPermissionDto"},"capabilities":{"$ref":"#/components/schemas/CapabilitiesDto"}},"required":["accountId","isPrimary","integrationStatus"]},"OAuthCallbackDataDto":{"type":"object","properties":{"adAccounts":{"type":"array","items":{"$ref":"#/components/schemas/FacebookAdAccountDto"}},"pages":{"description":"Facebook pages data","type":"array","items":{"type":"object"}},"tokenStored":{"type":"boolean","example":true},"needsAdAccountSelection":{"type":"boolean","example":true}},"required":["adAccounts","pages","tokenStored","needsAdAccountSelection"]},"FacebookOAuthCallbackResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Facebook OAuth callback handled successfully"},"data":{"$ref":"#/components/schemas/OAuthCallbackDataDto"}},"required":["success","message","data"]},"AdAccountsListDataDto":{"type":"object","properties":{"adAccounts":{"type":"array","items":{"$ref":"#/components/schemas/FacebookAdAccountDto"}},"hasPrimary":{"type":"boolean","example":true},"total":{"type":"number","example":3},"readyForCampaigns":{"type":"number","example":1},"needsSetup":{"type":"number","example":2},"assignmentFailed":{"type":"number","example":0}},"required":["adAccounts","hasPrimary","total","readyForCampaigns","needsSetup","assignmentFailed"]},"AdAccountsListResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Ad accounts retrieved successfully"},"data":{"$ref":"#/components/schemas/AdAccountsListDataDto"}},"required":["success","message","data"]},"RemoveAccountResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Ad account removed successfully"}},"required":["success","message"]},"SelectPrimaryAdAccountDto":{"type":"object","properties":{"adAccountId":{"type":"string","example":"act_123456789","description":"Facebook Ad Account ID to set as primary"}},"required":["adAccountId"]},"SelectPrimaryDataDto":{"type":"object","properties":{"adAccountId":{"type":"string","example":"act_1087932189349950"},"assignmentStatus":{"type":"string","example":"ASSIGNED","enum":["ASSIGNED","ASSIGNMENT_FAILED"]},"canCreateCampaigns":{"type":"boolean","example":true},"grantedTasks":{"example":["MANAGE","ADVERTISE","ANALYZE"],"type":"array","items":{"type":"string"}},"message":{"type":"string","example":"Account selected successfully"}},"required":["adAccountId","assignmentStatus","canCreateCampaigns","grantedTasks","message"]},"SelectPrimaryResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Primary ad account set and ready for campaigns"},"data":{"$ref":"#/components/schemas/SelectPrimaryDataDto"}},"required":["success","message","data"]},"PrimaryAccountDataDto":{"type":"object","properties":{"account":{"$ref":"#/components/schemas/FacebookAdAccountDto"},"integrationStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS","enum":["SETUP_INCOMPLETE","SYSTEM_USER_ASSIGNED","ASSIGNMENT_FAILED","READY_FOR_CAMPAIGNS"]},"systemUserPermission":{"$ref":"#/components/schemas/SystemUserPermissionDto"},"capabilities":{"$ref":"#/components/schemas/CapabilitiesDto"},"readyForCampaigns":{"type":"boolean","example":true}},"required":["account","integrationStatus","systemUserPermission","capabilities","readyForCampaigns"]},"PrimaryAccountResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Primary ad account retrieved successfully"},"data":{"$ref":"#/components/schemas/PrimaryAccountDataDto"},"hasPrimary":{"type":"boolean","example":true}},"required":["success","message","hasPrimary"]},"TokenStatusDataDto":{"type":"object","properties":{"hasValidToken":{"type":"boolean","example":true},"expiresAt":{"format":"date-time","type":"string","example":"2024-02-15T10:00:00Z"},"daysUntilExpiry":{"type":"number","example":45},"needsReauth":{"type":"boolean","example":false},"reAuthUrl":{"type":"string","example":null}},"required":["hasValidToken","needsReauth"]},"TokenStatusResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Token is healthy and valid for 45 more days"},"data":{"$ref":"#/components/schemas/TokenStatusDataDto"}},"required":["success","message","data"]},"NewAccountDto":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"name":{"type":"string","example":"My New Store Ads"},"currency":{"type":"string","example":"USD"},"businessName":{"type":"string","example":"My Business"}},"required":["accountId","name","currency","businessName"]},"PermissionUpdateDto":{"type":"object","properties":{"accountId":{"type":"string","example":"act_1087932189349950"},"oldStatus":{"type":"string","example":"SETUP_INCOMPLETE"},"newStatus":{"type":"string","example":"READY_FOR_CAMPAIGNS"},"capabilities":{"$ref":"#/components/schemas/CapabilitiesDto"}},"required":["accountId","oldStatus","newStatus","capabilities"]},"TokenStatusDto":{"type":"object","properties":{"isValid":{"type":"boolean","example":true},"expiresAt":{"format":"date-time","type":"string","example":"2024-02-15T10:00:00Z"},"daysUntilExpiry":{"type":"number","example":45}},"required":["isValid"]},"RefreshAccountsDataDto":{"type":"object","properties":{"newAccountsFound":{"type":"number","example":1},"accountsUpdated":{"type":"number","example":2},"permissionsUpdated":{"type":"number","example":1},"accountsRemoved":{"type":"number","example":0},"totalAccounts":{"type":"number","example":4},"newAccounts":{"type":"array","items":{"$ref":"#/components/schemas/NewAccountDto"}},"permissionUpdates":{"type":"array","items":{"$ref":"#/components/schemas/PermissionUpdateDto"}},"tokenStatus":{"$ref":"#/components/schemas/TokenStatusDto"}},"required":["newAccountsFound","accountsUpdated","permissionsUpdated","accountsRemoved","totalAccounts","newAccounts","permissionUpdates","tokenStatus"]},"RefreshAccountsResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Found 1 new ad account and updated 2 existing accounts"},"data":{"$ref":"#/components/schemas/RefreshAccountsDataDto"}},"required":["success","message","data"]}}}}